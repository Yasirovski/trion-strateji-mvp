<!DOCTYPE html>
<html lang="tr">
<head>
    <style>
        body { margin:0; font-family:Arial, sans-serif; }
        header, footer { padding:10px; background:#222; color:#fff; }
        header h1 { display:inline; margin:0; font-size:1.5em; }
        header nav { float:right; }
        header button { margin-left:10px; padding:5px 10px; background:#444; border:none; color:#fff; cursor:pointer; }
        .container { display:flex; min-height:calc(100vh - 80px); }
        .sidebar, .news { width:20%; padding:10px; box-sizing:border-box; }
        .main { flex:1; padding:10px; box-sizing:border-box; }
        #gauge-container { text-align:center; margin-top:10px; }
        #gauge-value { font-size:2em; margin-bottom:5px; }
        progress { width:100%; height:20px; }
        #watchlist iframe, #chart iframe { width:100%; height:400px; border:0; }
        @media(max-width:768px){
          .container { flex-direction:column; }
          .sidebar, .news { width:100%; }
        }
        /* RSS Styles */
        #rss-feed h3 { margin-top:0; }
        #rss-feed ul { list-style:none; padding:0; }
        #rss-feed li { margin-bottom:8px; }
        #rss-feed a { text-decoration:none; color:#444; }
        #rss-feed a:hover { text-decoration:underline; }
      </style>
      
  <meta charset="UTF-8">
  <title>Trion Strateji</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google AdSense Başlatma Kodu -->
  <script async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5776496009950122"
    crossorigin="anonymous"></script>

  <style>
    body { margin:0; font-family:Arial, sans-serif; }
    header, footer { padding:10px; background:#222; color:#fff; }
    header h1 { display:inline; margin:0; font-size:1.5em; }
    header nav { float:right; }
    header button { margin-left:10px; padding:5px 10px; background:#444; border:none; color:#fff; cursor:pointer; }
    .container { display:flex; min-height:calc(100vh - 80px); }
    .sidebar, .news { width:20%; padding:10px; box-sizing:border-box; }
    .main { flex:1; padding:10px; box-sizing:border-box; }
    #gauge-container { text-align:center; margin-top:10px; }
    #gauge-value { font-size:2em; margin-bottom:5px; }
    progress { width:100%; height:20px; }
    #watchlist iframe, #chart iframe { width:100%; height:400px; border:0; }
    @media(max-width:768px){
      .container { flex-direction:column; }
      .sidebar, .news { width:100%; }
    }
    /* RSS Styles */
    #rss-feed h3 { margin-top:0; }
    #rss-feed ul { list-style:none; padding:0; }
    #rss-feed li { margin-bottom:8px; }
    #rss-feed a { text-decoration:none; color:#444; }
    #rss-feed a:hover { text-decoration:underline; }
  </style>
</head>
<body>

<header>
  <h1>Trion Strateji</h1>
  <nav>
    <button onclick="switchMarket('BIST')">Borsa İstanbul</button>
    <button onclick="switchMarket('USA')">Amerika B.</button>
    <button onclick="switchMarket('CMD')">Emtialar</button>
  </nav>
</header>

<div class="container">
  <!-- Sol Sütun: Watchlist -->
  <aside class="sidebar">
    <div id="watchlist"></div>
  </aside>

  <!-- Orta Bölüm: Grafik ve Gauge -->
  <section class="main">
    <div id="chart"></div>
    <div id="gauge-container">
      <div id="gauge-value">--</div>
      <progress id="gauge" max="100" value="0"></progress>
    </div>
  </section>

  <!-- Sağ Sütun: Reklam & Haber -->
  <aside class="news">
    <!-- AdSense Reklam Birimi -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-5776496009950122"
         data-ad-slot="5878236921"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <!-- RSS Haber Akışı -->
    <div id="rss-feed">
      <h3>Finans Haberleri</h3>
      <ul id="news-list"></ul>
    </div>
  </aside>
</div>

<footer>
  <a href="about.html" style="color:#ccc; text-decoration:none;">Hakkında</a> |
  <a href="contact.html" style="color:#ccc; text-decoration:none;">İletişim</a>
</footer>

<script>
  // Market konfigürasyonu
  const config = {
    BIST: { wl: 'BIST30',       chart: 'XU100',  gaugeURL: 'api/index/greed.json' },
    USA : { wl: 'NASDAQ_TOP10', chart: 'SPX',     gaugeURL: 'api/index/greed-usa.json' },
    CMD : { wl: 'CMD_LIST',     chart: 'XAUUSD',  gaugeURL: 'api/index/greed-cmd.json' }
  };

  // Watchlist iframe
  function loadWatchlist(market) {
    document.getElementById('watchlist').innerHTML =
      `<iframe src="https://s.tradingview.com/embed-widget/symbol-list/?symbols=${config[market].wl}"></iframe>`;
  }

  // Chart iframe
  function loadChart(market) {
    document.getElementById('chart').innerHTML =
      `<iframe src="https://s.tradingview.com/embed-widget/chart/?symbol=${config[market].chart}"></iframe>`;
  }

  // Gauge değeri çek ve güncelle
  function loadGauge(market) {
    fetch(config[market].gaugeURL)
      .then(res => res.json())
      .then(data => {
        const v = Math.round(data.value);
        document.getElementById('gauge-value').textContent = v;
        document.getElementById('gauge').value = v;
      })
      .catch(err => {
        document.getElementById('gauge-value').textContent = 'Err';
        console.error(err);
      });
  }

  // RSS haberleri çek
  (function loadRSS() {
    const RSS_URL = 'https://rss.investing.com/top-news.rss';
    const API = 'https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent(RSS_URL);
    fetch(API)
      .then(res => res.json())
      .then(data => {
        const ul = document.getElementById('news-list');
        data.items.slice(0,5).forEach(item => {
          const li = document.createElement('li');
          li.innerHTML = `<a href="${item.link}" target="_blank">${item.title}</a>`;
          ul.appendChild(li);
        });
      })
      .catch(console.error);
  })();

  // Piyasa değiştir
  function switchMarket(market) {
    loadWatchlist(market);
    loadChart(market);
    loadGauge(market);
  }

  // İlk açılışta BIST seçili olsun
  switchMarket('BIST');
</script>

</body>
</html>
